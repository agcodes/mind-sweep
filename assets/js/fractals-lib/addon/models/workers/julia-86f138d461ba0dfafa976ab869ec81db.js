!function(e,t){e.requestAnimFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)};e.JuliaDrawer=function(e){if(!e)throw"L'Id d'une zone de dessin est obligatoire pour creer une instance de cet objet.";var n=this,a=new Canvas2DDrawer(e),o=a.getBackBuffer(),i=a.getWidth(),r=a.getHeight(),s=200,u=new Palette,l=new Complex(-.85,.2),f=new Complex(1,1);this.getConstant=function(){return l},this.setConstant=function(e,t){l.a=e,l.b=t};this.createPalette=function(e,t,n,a){for(var o=1,i=[],r=arguments.length;o<r;++o)i.push(arguments[o]);u.create(e,i)};var c=0,m=0,h=!1;this.animate=function(){c+=.01,m+=.001,n.setConstant(Math.cos(c),Math.sin(m))},this.setAnimate=function(e){c=Math.acos(l.a),m=Math.asin(l.b),s=(h=e)?50:200};var w=function(e,t){for(var n=e.a,a=e.b,o=0,i=0;o<4&&i<s;)i++,e.a=n,e.b=a,o=(n=e.a*e.a-e.b*e.b+t.a)*n+(a=e.a*e.b*2-t.b)*a;return.5+(o=(o=o>4?4*i+o:0)<256?o>0?o:0:255)|0};this.start=function(){var e=new Palette.Color(0,0,0,255,0),t=new Palette.Color(0,0,255,255,20),a=new Palette.Color(0,255,255,255,40),o=new Palette.Color(255,255,0,255,60),i=new Palette.Color(255,0,0,255,80),r=new Palette.Color(0,0,0,255,100);n.createPalette(256,e,t,a,o,i,r),n.draw()},this.draw=function(e,s){if(requestAnimFrame((function(){n.draw()})),h&&n.animate(),e!=t&&s!=t&&(l=new Complex(e,s)),!f.isEquals(l)){f.copy(l);var c,m,b,C=new Complex;for(m=0;m<r;m++)for(c=0;c<i;c++)d=c,g=m,(v=C).a=d/i*3.6-1.8,v.b=g/r*3.6-1.8,level=w(C,l),b=u.getColor(level),o[m*i+c]=a.pixel(b.r,b.g,b.b,b.a);null!=o&&a.setBackBuffer(o),n.notify(l)}var v,d,g};var b=[];this.subscribe=function(e){b.push(e)},this.notify=function(e){for(var t=b.length;t;)b[t-=1](e.a,e.b)}}}(window);