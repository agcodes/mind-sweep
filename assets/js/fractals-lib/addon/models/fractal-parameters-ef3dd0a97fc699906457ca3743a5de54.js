import CComplex from"./CComplex";export default class FractalParameters{modelID="";a=null;b=null;c=null;args=null;c2=null;multiple=null;min=4;min_o=4;type="";f="";base=1;method=1;selectMode=6;render3D=!1;minOccurrences=0;maxOccurrences=360;inner=!1;out=!0;autoAdjust=!0;multiRandom=!1;r=2.5;zThresholds=null;edgeDetect=0;gaussianFilter=0;z0=0;x1=-2.5;y1=-2.5;x2=2.5;y2=2.5;x1_o=-2;y1_o=-2;x2_o=2;y2_o=2;ySymetry=!1;xSymetry=!1;drColor=null;innerColor=null;bgColor=null;innerColor_o=null;bgColor2=null;varInterval=null;innerMethod=0;fixedInnerColor=null;noise=null;d3=0;colorsI=null;target=4;minIterations=0;maxIterations=0;itInterval=null;dW=!1;ifs=0;ifsIterations=25;ifsMultiple=2;ifsParams=null;breakPtParams=null;zValues=null;areas=null;setAB_OnClick=!1;zMethod=0;zOrigin=null;colorsService=null;animation=[];mode=0;zFromOrigin=!1;derivativeFunction=null;derivativeParams=null;colorsLevels=null;colorsThresholds=null;relativeC2=!1;lpNb=0;position3D=null;constructor(){this.colorsI=[]}setData(t){return this.ifsParams=null,this.target=4,this.a=null,this.b=null,this.c=0,this.x1=-2.5,this.x2=2.5,this.y1=-2.5,this.y2=2.5,this.zThresholds=null,this.bgColor=null,this.drColor=[210,50,50],this.innerColor=[210,50,50],this.position3D=[1,1,1],!!t&&(this.modelID=t.id,"number"==typeof t.a&&(this.a=t.a),"number"==typeof t.b&&(this.b=t.b),"number"==typeof t.c&&(this.c=t.c),"number"==typeof t.target&&(this.target=t.target),this.initLimits(t),this.type="string"==typeof t.type?t.type:"j_o",this.inner="boolean"==typeof t.inner&&t.inner,this.out="boolean"!=typeof t.out||t.out,this.method="number"==typeof t.method?t.method:1,this.maxIterations="number"==typeof t.iterations?t.iterations:50,this.f="string"==typeof t.f?t.f:"",this.derivativeParams="object"==typeof t.derivativeParams?t.derivativeParams:null,null!==t.drColor&&"object"==typeof t.drColor&&(this.drColor=t.drColor),null!==t.innerColor&&"object"==typeof t.innerColor?this.innerColor=t.innerColor:this.innerColor=this.drColor,this.innerMethod="number"==typeof t.innerMethod?t.innerMethod:0,this.innerMethod>0&&(this.inner=!0),this.ifsParams=this.getNew(),t.ifsParams?this.ifsParams.setData(t.ifsParams):(this.ifsParams.mode="number"==typeof t.ifs?t.ifs:0,this.ifsParams.mode>0&&(this.ifsParams.maxIterations="number"==typeof t.ifsIterations?t.ifsIterations:25,this.ifsParams.type="multiple",this.ifsParams.f="",this.ifsParams.args=[2,0],this.ifsParams.setC0(),this.ifsParams.setFunctions())),this.selectMode="number"==typeof t.selectMode?t.selectMode:6,this.min="number"==typeof t.min?t.min:0,this.base="number"==typeof t.base?t.base:2,this.minOccurrences="number"==typeof t.minOccurrences?t.minOccurrences:0,this.maxOccurrences="number"==typeof t.maxOccurrences?t.maxOccurrences:360,this.itInterval="object"==typeof t.itInterval?t.itInterval:null,this.bgColor="object"==typeof t.bgColor?t.bgColor:null,this.bgColor2="object"==typeof t.bgColor2?t.bgColor2:null,this.args="object"==typeof t.args?t.args:[],this.relativeC2="boolean"==typeof t.relativeC2&&t.relativeC2,this.lpNb="number"==typeof t.lpNb?t.lpNb:0,this.relativeC2?this.c2=null:this.c2=void 0===t.c2?new CComplex(0,0,0):new CComplex(t.c2.a,t.c2.b),this.zFromOrigin="boolean"==typeof t.zFromOrigin&&t.zFromOrigin,this.zFromOrigin?this.zOrigin=new CComplex(0,0,0):this.zOrigin=void 0===t.zOrigin?null:new CComplex(t.zOrigin.a,t.zOrigin.b),this.multiple=void 0===t.multiple?null:new CComplex(t.multiple.r,t.multiple.i),this.d3="number"==typeof t.d3?t.d3:0,this.z0="number"==typeof t.z0?t.z0:0,this.zMethod="number"==typeof t.zMethod?t.zMethod:0,this.edgeDetect="number"==typeof t.edgeDetect?t.edgeDetect:0,this.gaussianFilter="number"==typeof t.gaussianFilter?t.gaussianFilter:0,this.dW="boolean"==typeof t.dW&&t.dW,this.areas="object"==typeof t.areas?t.areas:null,this.noise="object"==typeof t.noise?t.noise:null,this.breakPtParams="object"==typeof t.breakPtParams?t.breakPtParams:null,this.breakPtParams&&void 0===this.breakPtParams.base&&(this.breakPtParams.base=this.base,this.breakPtParams.f=this.f),this.bgAuto="boolean"==typeof t.bgAuto&&t.bgAuto,this.render3D="boolean"==typeof t.render3D&&t.render3D,this.multiRandom="boolean"==typeof t.multiRandom&&t.multiRandom,this.mode="number"==typeof t.mode?t.mode:0,this.colorsLevels="object"==typeof t.colorsLevels?t.colorsLevels:null,this.colorsThresholds="object"==typeof t.colorsThresholds?t.colorsThresholds:null,this.xSymetry="boolean"==typeof t.xSymetry&&t.xSymetry,this.ySymetry="boolean"==typeof t.ySymetry&&t.ySymetry,this.setAB_OnClick="boolean"==typeof t.setAB_OnClick&&t.setAB_OnClick,t.animation&&(this.animation=t.animation),void 0!==t.animation&&null!==t.animation||(this.animation=[],this.animation.z0=0,this.animation.mode=0),null!==t.zThresholds&&"object"==typeof t.zThresholds&&(this.zThresholds=t.zThresholds,this.render3D=!0),this.zValues="object"==typeof t.zValues?t.zValues:null,this.pt=null,this.setOriginPoints(),this.min_o=this.min,this.minIterations=this.min,this.innerColor_o=[this.innerColor[0],this.innerColor[1],this.innerColor[2],this.innerColor[3]],1===this.method&&"number"!=typeof this.drColor[6]&&(this.drColor[6]=7,this.drColor[2]=1),"number"!=typeof this.drColor[3]&&(this.drColor[3]=100),"number"!=typeof this.drColor[4]&&(this.drColor[4]=1),"number"!=typeof this.drColor[5]&&(this.drColor[5]=1),"number"!=typeof this.drColor[6]&&(this.drColor[6]=1),"number"!=typeof this.drColor[7]&&(this.drColor[7]=0),this.setInitPoints(),this.setC0(),this.setFunctions())}initLimits(t){this.autoAdjust="boolean"==typeof t.autoAdjust&&t.autoAdjust,"number"==typeof t.r&&(!0===this.autoAdjust&&(t.r=1.05*t.r),this.x2=parseFloat(t.r),this.x1=-this.x2,this.y1=this.x1,this.y2=this.x2),"number"==typeof t.x1&&(this.x1=t.x1),"number"==typeof t.y1&&(this.y1=t.y1),"number"==typeof t.x2?this.x2=t.x2:this.x2=-this.x1,"number"==typeof t.y2?this.y2=t.y2:this.y2=-this.y1}setFunctions(){}getNew(){return new FractalParameters}setC0(){null===this.a||!0===this.relativeC?this.c0=null:(null===this.b&&(this.b=0),this.c0=new CComplex(this.a,this.b,this.c))}setDrColor(t,i){if(this.colorsService=i,i&&(this.drColor=t,null===this.drColor&&(this.drColor=[0,0,0]),this.colorsI=[],this.fixedDrColor=i.hslToRgb(this.drColor),this.method<=10))for(let t=0;t<=this.maxIterations+10;t++){const s=this.getIColorValue(t);this.colorsI.push(i.hslToRgb([this.drColor[0]+s*this.drColor[4],this.drColor[1]+s*this.drColor[5],this.drColor[2]+s*this.drColor[6],this.drColor.length>=8?this.drColor[3]+s*this.drColor[7]:null]))}return null}getDrColor(t,i,s,o,e,r){if(this.colorsService)return 0===this.colorsI.length?0===i?this.fixedDrColor:this.colorsService.hslToRgb([this.drColor[0]+s*this.drColor[4],this.drColor[1]+o*this.drColor[5],this.drColor[2]+e*this.drColor[6],this.drColor.length>=8?this.drColor[3]+r*this.drColor[7]:null]):this.colorsI[t]}getIColorValue(t){if(this.colorsThresholds&&this.colorsLevels)for(let i=0;i<this.colorsThresholds.length;i++)if(this.colorsThresholds[i]>=t)return this.colorsLevels[i];switch(this.method){case 1:return t;case 2:return 0===t?0:Math.log(t);case 3:return 1/t*100;case 4:return 0===t?0:Math.sin(Math.log(t))+1;case 5:return t%2==0?0:10;case 6:return 10*Math.ceil(t/10);case 7:return 1;case 8:return 0===t?0:Math.atan2(t,this.maxIterations/2);case 9:return Math.tan(t);case 10:return 0===t?0:Math.log10(t);default:return-1}}setInnerColor(t,i){if(this.colorsService&&(this.innerColor=t,"number"!=typeof this.innerColor[4]&&(this.innerColor[4]=0),"number"!=typeof this.innerColor[5]&&(this.innerColor[5]=0),"number"!=typeof this.innerColor[6]&&(this.innerColor[6]=0),0==this.innerMethod))if([1,2,3,4,5,9,10].includes(this.method)){const t=this.getIColorValue(this.maxIterations);this.fixedInnerColor=this.getInnerColor(t,t,t,t,t,!0)}else this.fixedInnerColor=i.hslToRgb(this.innerColor)}getInnerColor(t,i,s,o,e,r){if(this.colorsService)return this.innerMethod>0||!0===r||this.method>4?0===t?this.fixedInnerColor:this.colorsService.hslToRgb([this.innerColor[0]+i*this.innerColor[4],this.innerColor[1]+s*this.innerColor[5],this.innerColor[2]+o*this.innerColor[6],this.innerColor.length>=8?this.innerColor[3]+e*this.innerColor[7]:null]):this.fixedInnerColor}setLimits(t,i,s){let o=0,e=0;!0===this.dW&&s>1&&(o=Math.abs(this.x2_o-this.x1_o)/2*(s-1)),i>t&&(e=Math.abs(this.y2_o-this.y1_o)/2),this.x1=this.x1_o-o,this.x2=this.x2_o+o,this.y1=this.y1_o-e,this.y2=this.y2_o+e}setInitPoints(){this.x1_i=this.x1,this.x2_i=this.x2,this.y1_i=this.y1,this.y2_i=this.y2,!0===this.xSymetry&&Math.abs(this.x1)!=Math.abs(this.x2)&&(this.xSymetry=!1)}setOriginPoints(){this.x1_o=this.x1,this.x2_o=this.x2,this.y1_o=this.y1,this.y2_o=this.y2}restoreInitPoints(){this.x1=this.x1_i,this.x2=this.x2_i,this.y1=this.y1_i,this.y2=this.y2_i,this.setOriginPoints()}defIntervalPts(t,i,s,o){this.x1=t,this.y1=i,this.x2=s,this.y2=o}changeParameter(t,i){switch(t){case"change_a":return this.a=parseFloat(i),this.setC0(),!0;case"change_b":return this.b=parseFloat(i),this.setC0(),!0;case"change_base":return this.base=parseFloat(i),!0;case"change_inner":if(this.inner=1===parseInt(i),!0===this.inner||!0===this.out)return!0;break;case"change_out":if(this.out=1===parseInt(i),!0===this.inner||!0===this.out)return!0;break;case"change_iterations":return this.maxIterations=parseInt(i),!0;case"change_method":return this.method=parseInt(i),!0;case"change_min":return this.minIterations=parseInt(i),this.min=this.minIterations,!0;case"change_x1":return this.x1=parseFloat(i),this.setOriginPoints(),!0;case"change_x2":return this.x2=parseFloat(i),this.setOriginPoints(),!0;case"change_y1":return this.y1=parseFloat(i),this.setOriginPoints(),!0;case"change_y2":return this.y2=parseFloat(i),this.setOriginPoints(),!0;case"change_funcName":return this.f=i,!0;case"change_noisex":return null===this.noise&&(this.noise=[0,0,0]),this.noise[0]=parseFloat(i),!0;case"change_noisey":return null===this.noise&&(this.noise=[0,0,0]),this.noise[1]=parseFloat(i),!0}}setVarParameters(t){return!!(t&&this.animation&&this.animation.mode&&this.animation.mode>0)&&(2===this.animation.mode&&this.animation.innerColor&&(this.innerColor[0]=Math.round(this.innerColor_o[0]+Math.sin(this.z0)*this.animation.innerColor[4]),this.innerColor[1]=Math.round(this.innerColor_o[1]+Math.sin(this.z0)*this.animation.innerColor[5]),this.innerColor[2]=Math.round(this.innerColor_o[2]+Math.sin(this.z0)*this.animation.innerColor[6]),this.fixedInnerColor=t.hslToRgb(this.innerColor)),this.applyAnimationVariation(t))}applyAnimationVariation(t){if(this.animation){if("number"==typeof this.animation.min&&(this.min+=this.animation.min),"number"==typeof this.animation.iterations&&(this.maxIterations+=this.animation.iterations),"number"==typeof this.animation.z0&&(this.z0+=this.animation.z0,this.z0=this.roundFloat(this.z0)),"number"==typeof this.animation.a&&(this.a+=this.animation.a,this.a=this.roundFloat(this.a)),"number"==typeof this.animation.b&&(this.b+=this.animation.b,this.b=this.roundFloat(this.b)),"number"==typeof this.animation.c&&(this.c+=this.animation.c,this.c=this.roundFloat(this.c)),"number"==typeof this.animation.hue&&(this.drColor[4]+=this.animation.hue),"number"==typeof this.animation.r&&(this.x1=this.x1_o*(1-this.animation.r),this.x2=this.x2_o*(1-this.animation.r),this.x1_o=this.x1,this.x2_o=this.x2,this.y1=this.y1_o*(1-this.animation.r),this.y2=this.y2_o*(1-this.animation.r),this.y1_o=this.y1,this.y2_o=this.y2),this.animation.args&&null!==this.args&&this.animation.args.length==this.args.length)for(let t=0;t<this.args.length;t++)this.animation.args[t]&&(this.args[t]+=this.animation.args[t]);return this.animation.args&&this.animation.args&&this.animation.args.rot&&(this.args.rot+=this.animation.args.rot),this.animation.noise&&"object"==typeof this.animation.noise&&null!=this.noise&&"object"==typeof this.noise&&this.noise.length>=3&&(this.noise[0]+=this.animation.noise[0],this.noise[1]+=this.animation.noise[1],this.noise[2]+=this.animation.noise[2]),this.animation.c2&&null!=this.c2&&(this.c2.a+=this.animation.c2.a,this.c2.b+=this.animation.c2.b),this.animation.multiple&&null!=this.multiple&&"object"==typeof this.animation.base&&(this.multiple.r+=this.animation.multiple.r,this.multiple.i+=this.animation.multiple.i),this.animation.breakPtParams&&null!=this.breakPtParams&&(this.breakPtParams.a+=this.animation.breakPtParams.a,this.breakPtParams.b+=this.animation.breakPtParams.b,this.breakPtParams.min+=this.animation.breakPtParams.min),"number"==typeof this.animation.base&&(this.base+=this.animation.base),this.setC0(),this.setFunctions(),this.ifsParams&&this.ifsParams.applyAnimationVariation(),!0}return!1}roundFloat(t){return Math.floor(1e8*t)/1e8}getInterval(){return[[this.x1,this.y1],[this.x1,this.y2],[this.x2,this.y1],[this.x2,this.y2]]}}