(()=>{"use strict";var t=function(){function t(t,i,s){this.x=t,this.y=i,this.r=t,this.i=i,this.t="number"==typeof s?s:0,this.square=0}var i=t.prototype;return i.rot=function(i){var s=Math.cos(i),n=Math.sin(i);return new t(this.r*s-this.i*n,this.r*n+this.i*s)},i.transform=function(t){return null===t||0===t.length||(this.r+=t[0],1==t.length||(this.i+=t[1],2==t.length||(this.t+=t[2],3==t.length||(t.length>3&&(this.r*=t[3]),t.length>4&&(this.i*=t[4]),t.length>5&&(this.t*=t[5]))))),this},i.setSquare=function(){return this.square=this.squaresSum(),this.square},i.getArgument=function(){return Math.atan2(this.i,this.r)},i.squaresSum=function(){return this.r*this.r+this.i*this.i},i.getMagnitude=function(){return Math.sqrt(this.squaresSum())},i.LyapunovExponent=function(t){for(var i=0,s=0,n=0;n<t;n++){var r=i*i-s*s+this.r;s=2*i*s+this.i,i=r}return Math.sqrt(i*i+s*s)-1},i.LyapunovExponent_=function(t){for(var i=0,s=0,n=0;n<t;n++){var r=i*i-s*s+this.r,e=2*i*s+this.i;i=r,s=e}return Math.sqrt(i*i+s*s)-1},i.signR=function(){return this.r<0?-1:0===this.r?0:this.r>0?1:void 0},i.addValues=function(i,s,n){return new t(this.r+i,this.i+s,this.t+n)},i.addValuesIn=function(t,i,s){return this.r+=t,this.i+=i,this.t+=s,this},i.addReal=function(i){return new t(this.r+i,this.i,this.t)},i.addIn=function(t){return this.r+=t.r,this.i+=t.i,this.t+=t.t,this},i.add=function(i){return new t(this.r+i.r,this.i+i.i,this.t+i.t)},i.sub=function(i){return new t(this.r-i.r,this.i-i.i,this.t-i.t)},i.subIn=function(t){return this.r-=t.r,this.i-=t.i,this.t-=t.t,this},i.mulValues=function(t,i,s){return this.r=this.r*t-this.i*i,this.i=this.i*t+this.r*i,this},i.mul=function(i){return new t(this.r*i.r-this.i*i.i,this.i*i.r+this.r*i.i,this.t)},i.mulReal=function(i){return new t(this.r*i,this.i*i,this.t*i)},i.mulRReal=function(i){return new t(this.r*i,this.i,this.t)},i.div=function(i){var s=i.r*i.r+i.i*i.i+i.t*i.t;return new t((this.r*i.r+this.i*i.i)/s,(this.i*i.r-this.r*i.i)/s,this.t)},i.inverse=function(){this.setSquare();var i=new t(1,0,0),s=this.square+this.t*this.t;return new t((i.r*this.r+i.i*this.i)/s,(i.i*this.r-i.r*this.i)/s)},i.iAbs=function(){return new t(this.r,Math.abs(this.i),this.t)},i.rAbs=function(){return new t(Math.abs(this.r),this.i,this.t)},i.abs=function(){return new t(Math.abs(this.r),Math.abs(this.i),Math.abs(this.t))},i.opposite=function(){return new t(-this.r,-this.i,-this.t)},i.conjugate=function(){return new t(this.r,-this.i,this.t)},i.pow=function(i){if("number"==typeof this.t&&0!==this.t&&i>1&&i%2==0)return this.pow3d(i);switch(i){case 0:return new t(1,0,0);case 1:return new t(this.r,this.i,this.t);case 2:return new t(this.r*this.r-this.i*this.i,2*this.r*this.i);case 3:return new t(Math.pow(this.r,3)-3*this.r*this.i*this.i,3*this.r*this.r*this.i-Math.pow(this.i,3));case 4:return new t(Math.pow(this.r,4)-6*this.r*this.r*this.i*this.i+Math.pow(this.i,4),4*Math.pow(this.r,3)*this.i-4*this.r*Math.pow(this.i,3))}var s=this.getArgument(),n=this.getMagnitude();return new t(Math.cos(i*s)*Math.pow(n,i),Math.sin(i*s)*Math.pow(n,i))},i.pow3d=function(i){for(var s=new t(this.r,this.i,this.t),n=0;n<i/2;n++)s=s.square3d();return s},i.powComplex=function(i){var s=Math.sqrt(this.r**2+this.i**2),n=Math.atan2(this.i,this.r),r=Math.exp(i.r*Math.log(s)-i.i*n),e=i.r*n+i.i*Math.log(s);return new t(r*Math.cos(e),r*Math.sin(e))},i.expComplex=function(){var i=Math.exp(this.r);return new t(i*Math.cos(this.i),i*Math.sin(this.i))},i.square3d=function(){return new t(this.r*this.r-this.i*this.i-this.t*this.t,2*this.r*this.i,2*this.r*this.t)},i.isZero=function(){return 0===this.i&&0===this.r},i.getC=function(t){switch(t){case"":case"0":default:return this;case"rAbs":case"iAbs":return this.rAbs();case"abs":return this.abs();case"inverse":return this.inverse();case"conjugate":return this.conjugate();case"opposite":return this.opposite();case"sin":return this.sin();case"cos":return this.cos();case"cosh":return this.cosh();case"sinh":return this.sinh();case"tan":return this.tan();case"tanh":return this.tanh();case"cot":return this.cot();case"coth":return this.coth();case"sec":return this.sec();case"sech":return this.sech();case"csc":return this.csc();case"csch":return this.csch();case"atan":return this.atan();case"acos":return this.acos();case"acosh":return this.acosh();case"acot":return this.acot();case"acoth":return this.acoth();case"asin":return this.asin();case"asinh":return this.asinh();case"asec":return this.asec();case"asech":return this.asech();case"acsc":return this.acsc();case"log":return this.log();case"exp":return this.expComplex();case"ln":return this.ln();case"sqrt":return this.sqrt();case"pow2":return this.pow(2);case"cosCoshSinSinh":return this.cosCoshSinSinh();case"cosCoshSinSinh2":return this.cosCoshSinSinh2();case"squareDiv":return this.squareDiv();case"squareTan":return this.squareTan();case"squareAtan":return this.squareAtan();case"expDiv":return this.expDiv();case"expDivSinh":return this.expDivSinh()}},i.sqrt=function(){var i=Math.sqrt(this.squaresSum());return new t(Math.sqrt((i+this.r)/2),i/Math.abs(i)*Math.sqrt((i-this.r)/2))},i.log=function(){return new t(this.logHypot(this.r,this.i),Math.atan2(this.i,this.r))},i.logHypot=function(t,i){var s=Math.abs(t),n=Math.abs(i);return 0===t?Math.log(n):0===i?Math.log(s):s<3e3&&n<3e3?.5*Math.log(t*t+i*i):Math.log(t/Math.cos(Math.atan2(i,t)))},i.sin=function(){return new t(Math.cosh(this.i)*Math.sin(this.r),Math.sinh(this.i)*Math.cos(this.r))},i.sinh=function(){return new t(Math.sinh(this.r)*Math.cos(this.i),Math.cosh(this.r)*Math.sin(this.i))},i.cos=function(){return new t(Math.cosh(this.i)*Math.cos(this.r),-Math.sinh(this.i)*Math.sin(this.r))},i.cosh=function(){return new t(Math.cosh(this.r)*Math.cos(this.i),Math.sinh(this.r)*Math.sin(this.i))},i.tan=function(){var i=Math.cos(2*this.r)+Math.cosh(2*this.i);return new t(Math.sin(2*this.r)/i,Math.sinh(2*this.i)/i)},i.tanh=function(){var i=Math.cosh(2*this.r)+Math.cos(2*this.i);return new t(Math.sinh(2*this.r)/i,Math.sin(2*this.i)/i)},i.cot=function(){var i=Math.cos(2*this.r)-Math.cosh(2*this.i);return new t(-Math.sin(2*this.r)/i,Math.sinh(2*this.i)/i)},i.coth=function(){var i=Math.cosh(2*this.r)-Math.cos(2*this.i);return new t(Math.sinh(2*this.r)/i,-Math.sin(2*this.i)/i)},i.sec=function(){var i=.5*Math.cosh(2*this.i)+.5*Math.cos(2*this.r);return new t(Math.cos(this.r)*Math.cosh(this.i)/i,Math.sin(this.r)*Math.sinh(this.i)/i)},i.sech=function(){var i=Math.cos(2*this.i)+Math.cosh(2*this.r);return new t(2*Math.cosh(this.r)*Math.cos(this.i)/i,-2*Math.sinh(this.r)*Math.sin(this.i)/i)},i.csc=function(){var i=.5*Math.cosh(2*this.i)-.5*Math.cos(2*this.r);return new t(Math.sin(this.r)*Math.cosh(this.i)/i,-Math.cos(this.r)*Math.sinh(this.i)/i)},i.csch=function(){var i=Math.cos(2*this.i)-Math.cosh(2*this.r);return new t(-2*Math.sinh(this.r)*Math.cos(this.i)/i,2*Math.cosh(this.r)*Math.sin(this.i)/i)},i.acos=function(){var i=new t(this.i*this.i-this.r*this.r+1,-2*this.r*this.i).pow(.5),s=new t(i.r-this.i,i.i+this.r).log();return new t(Math.PI/2-s.i,s.r)},i.acosh=function(){var t=this.acos(),i=0;return t.i<=0?(i=t.r,t.r=-t.i,t.i=i):(i=t.i,t.i=-t.r,t.r=i),t},i.asinh=function(){var t=this.i;this.i=-this.r,this.r=t;var i=this.asin();return this.r=-this.i,this.i=t,t=i.r,i.r=-i.i,i.i=t,i},i.acoth=function(){return 0===this.r&&0===this.i?new t(0,Math.PI/2):0===this.setSquare()?new t(1/0,1/0):new t(this.r/this.square,-this.i/this.square).atanh()},i.acsch=function(){return 0===this.i?new t(0!==this.r?Math.log(this.r+Math.sqrt(this.r*this.r+1)):1/0,0):0===this.setSquare()?new t(1/0,1/0):new t(this.r/this.square,-this.i/this.square).asinh()},i.asech=function(){return 0===this.setSquare()?new t(1/0,1/0):new t(this.r/this.square,-this.i/this.square).acosh()},i.asin=function(){var i=new t(this.i*this.i-this.r*this.r+1,-2*this.r*this.i).pow(.5),s=new t(i.r-this.i,i.i+this.r).log();return new t(s.i,-s.r)},i.acot=function(){return 0===this.setSquare()?new t(Math.atan2(1,this.r),0):new t(this.r/this.square,-this.i/this.square).atan()},i.asec=function(){return 0===this.setSquare()?new t(0,1/0):new t(this.r/this.square,-this.i/this.square).acos()},i.acsc=function(){return 0===this.setSquare()?new t(Math.PI/2,1/0):new t(this.r/this.square,-this.i/this.square).asin()},i.atan=function(){if(0===this.r){if(1===this.i)return new t(0,1/0);if(-1===this.i)return new t(0,-1/0)}var i=this.r*this.r+(1-this.i)*(1-this.i),s=new t((1-this.i*this.i-this.r*this.r)/i,-2*this.r/i).log();return new t(-.5*s.i,.5*s.r)},i.ln=function(){return this.setSquare(),new t(.5*Math.log10(this.square),Math.atan(this.r/this.i))},i.cosCoshSinSinh2=function(){return new t(Math.cosh(this.i)*Math.sin(this.r),-Math.sinh(this.i)*Math.cos(this.r),0)},i.cosCoshSinSinh=function(){return new t(Math.cosh(-this.i)*Math.cos(this.r),Math.sinh(-this.i)*Math.sin(this.r),0)},i.expDiv=function(){return new t(.5*Math.exp(this.squaresSum()),this.r/this.i,0)},i.expDivSinh=function(){return new t(.5*Math.exp(this.squaresSum()),Math.sinh(this.r/this.i),0)},i.squareDiv=function(){return new t(this.squaresSum(),this.r/this.i,0)},i.squareAtan=function(){return new t(this.squaresSum(),Math.atan(this.r/this.i),0)},i.squareTan=function(){return new t(this.squaresSum(),Math.tan(this.r/this.i),0)},t}(),i=function(){function i(){this.modelID="",this.a=null,this.b=null,this.c=null,this.args=null,this.c2=null,this.multiple=null,this.min=4,this.min_o=4,this.type="",this.f="",this.base=1,this.method=1,this.selectMode=6,this.render3D=!1,this.minOccurrences=0,this.maxOccurrences=360,this.inner=!1,this.out=!0,this.autoAdjust=!0,this.multiRandom=!1,this.r=2.5,this.zThresholds=null,this.edgeDetect=0,this.gaussianFilter=0,this.z0=0,this.x1=-2.5,this.y1=-2.5,this.x2=2.5,this.y2=2.5,this.x1_o=-2,this.y1_o=-2,this.x2_o=2,this.y2_o=2,this.ySymetry=!1,this.xSymetry=!1,this.drColor=null,this.innerColor=null,this.bgColor=null,this.innerColor_o=null,this.bgColor2=null,this.varInterval=null,this.innerMethod=0,this.fixedInnerColor=null,this.noise=null,this.d3=0,this.colorsI=null,this.target=4,this.minIterations=0,this.maxIterations=0,this.itInterval=null,this.dW=!1,this.ifs=0,this.ifsIterations=25,this.ifsMultiple=2,this.ifsParams=null,this.breakPtParams=null,this.zValues=null,this.areas=null,this.setAB_OnClick=!1,this.zMethod=0,this.zOrigin=null,this.colorsService=null,this.animation=[],this.mode=0,this.zFromOrigin=!1,this.derivativeFunction=null,this.derivativeParams=null,this.colorsLevels=null,this.colorsThresholds=null,this.relativeC2=!1,this.lpNb=0,this.position3D=null,this.colorsI=[]}var s=i.prototype;return s.setData=function(i){return this.ifsParams=null,this.target=4,this.a=null,this.b=null,this.c=0,this.x1=-2.5,this.x2=2.5,this.y1=-2.5,this.y2=2.5,this.zThresholds=null,this.bgColor=null,this.drColor=[210,50,50],this.innerColor=[210,50,50],this.position3D=[1,1,1],!!i&&(this.modelID=i.id,"number"==typeof i.a&&(this.a=i.a),"number"==typeof i.b&&(this.b=i.b),"number"==typeof i.c&&(this.c=i.c),"number"==typeof i.target&&(this.target=i.target),this.initLimits(i),this.type="string"==typeof i.type?i.type:"j_o",this.inner="boolean"==typeof i.inner&&i.inner,this.out="boolean"!=typeof i.out||i.out,this.method="number"==typeof i.method?i.method:1,this.maxIterations="number"==typeof i.iterations?i.iterations:50,this.f="string"==typeof i.f?i.f:"",this.derivativeParams="object"==typeof i.derivativeParams?i.derivativeParams:null,null!==i.drColor&&"object"==typeof i.drColor&&(this.drColor=i.drColor),null!==i.innerColor&&"object"==typeof i.innerColor?this.innerColor=i.innerColor:this.innerColor=this.drColor,this.innerMethod="number"==typeof i.innerMethod?i.innerMethod:0,this.innerMethod>0&&(this.inner=!0),this.ifsParams=this.getNew(),i.ifsParams?this.ifsParams.setData(i.ifsParams):(this.ifsParams.mode="number"==typeof i.ifs?i.ifs:0,this.ifsParams.mode>0&&(this.ifsParams.maxIterations="number"==typeof i.ifsIterations?i.ifsIterations:25,this.ifsParams.type="multiple",this.ifsParams.f="",this.ifsParams.args=[2,0],this.ifsParams.setC0(),this.ifsParams.setFunctions())),this.selectMode="number"==typeof i.selectMode?i.selectMode:6,this.min="number"==typeof i.min?i.min:0,this.base="number"==typeof i.base?i.base:2,this.minOccurrences="number"==typeof i.minOccurrences?i.minOccurrences:0,this.maxOccurrences="number"==typeof i.maxOccurrences?i.maxOccurrences:360,this.itInterval="object"==typeof i.itInterval?i.itInterval:null,this.bgColor="object"==typeof i.bgColor?i.bgColor:null,this.bgColor2="object"==typeof i.bgColor2?i.bgColor2:null,this.args="object"==typeof i.args?i.args:[],this.relativeC2="boolean"==typeof i.relativeC2&&i.relativeC2,this.lpNb="number"==typeof i.lpNb?i.lpNb:0,this.relativeC2?this.c2=null:this.c2=void 0===i.c2?new t(0,0,0):new t(i.c2.a,i.c2.b),this.zFromOrigin="boolean"==typeof i.zFromOrigin&&i.zFromOrigin,this.zFromOrigin?this.zOrigin=new t(0,0,0):this.zOrigin=void 0===i.zOrigin?null:new t(i.zOrigin.a,i.zOrigin.b),this.multiple=void 0===i.multiple?null:new t(i.multiple.r,i.multiple.i),this.d3="number"==typeof i.d3?i.d3:0,this.z0="number"==typeof i.z0?i.z0:0,this.zMethod="number"==typeof i.zMethod?i.zMethod:0,this.edgeDetect="number"==typeof i.edgeDetect?i.edgeDetect:0,this.gaussianFilter="number"==typeof i.gaussianFilter?i.gaussianFilter:0,this.dW="boolean"==typeof i.dW&&i.dW,this.areas="object"==typeof i.areas?i.areas:null,this.noise="object"==typeof i.noise?i.noise:null,this.breakPtParams="object"==typeof i.breakPtParams?i.breakPtParams:null,this.breakPtParams&&void 0===this.breakPtParams.base&&(this.breakPtParams.base=this.base,this.breakPtParams.f=this.f),this.bgAuto="boolean"==typeof i.bgAuto&&i.bgAuto,this.render3D="boolean"==typeof i.render3D&&i.render3D,this.multiRandom="boolean"==typeof i.multiRandom&&i.multiRandom,this.mode="number"==typeof i.mode?i.mode:0,this.colorsLevels="object"==typeof i.colorsLevels?i.colorsLevels:null,this.colorsThresholds="object"==typeof i.colorsThresholds?i.colorsThresholds:null,this.xSymetry="boolean"==typeof i.xSymetry&&i.xSymetry,this.ySymetry="boolean"==typeof i.ySymetry&&i.ySymetry,this.setAB_OnClick="boolean"==typeof i.setAB_OnClick&&i.setAB_OnClick,i.animation&&(this.animation=i.animation),void 0!==i.animation&&null!==i.animation||(this.animation=[],this.animation.z0=0,this.animation.mode=0),null!==i.zThresholds&&"object"==typeof i.zThresholds&&(this.zThresholds=i.zThresholds,this.render3D=!0),this.zValues="object"==typeof i.zValues?i.zValues:null,this.pt=null,this.setOriginPoints(),this.min_o=this.min,this.minIterations=this.min,this.innerColor_o=[this.innerColor[0],this.innerColor[1],this.innerColor[2],this.innerColor[3]],1===this.method&&"number"!=typeof this.drColor[6]&&(this.drColor[6]=7,this.drColor[2]=1),"number"!=typeof this.drColor[3]&&(this.drColor[3]=100),"number"!=typeof this.drColor[4]&&(this.drColor[4]=1),"number"!=typeof this.drColor[5]&&(this.drColor[5]=1),"number"!=typeof this.drColor[6]&&(this.drColor[6]=1),"number"!=typeof this.drColor[7]&&(this.drColor[7]=0),this.setInitPoints(),this.setC0(),this.setFunctions())},s.initLimits=function(t){this.autoAdjust="boolean"==typeof t.autoAdjust&&t.autoAdjust,"number"==typeof t.r&&(!0===this.autoAdjust&&(t.r=1.05*t.r),this.x2=parseFloat(t.r),this.x1=-this.x2,this.y1=this.x1,this.y2=this.x2),"number"==typeof t.x1&&(this.x1=t.x1),"number"==typeof t.y1&&(this.y1=t.y1),"number"==typeof t.x2?this.x2=t.x2:this.x2=-this.x1,"number"==typeof t.y2?this.y2=t.y2:this.y2=-this.y1},s.setFunctions=function(){},s.getNew=function(){return new i},s.setC0=function(){null===this.a||!0===this.relativeC?this.c0=null:(null===this.b&&(this.b=0),this.c0=new t(this.a,this.b,this.c))},s.setDrColor=function(t,i){if(this.colorsService=i,i&&(this.drColor=t,null===this.drColor&&(this.drColor=[0,0,0]),this.colorsI=[],this.fixedDrColor=i.hslToRgb(this.drColor),this.method<=10))for(var s=0;s<=this.maxIterations+10;s++){var n=this.getIColorValue(s);this.colorsI.push(i.hslToRgb([this.drColor[0]+n*this.drColor[4],this.drColor[1]+n*this.drColor[5],this.drColor[2]+n*this.drColor[6],this.drColor.length>=8?this.drColor[3]+n*this.drColor[7]:null]))}return null},s.getDrColor=function(t,i,s,n,r,e){if(this.colorsService)return 0===this.colorsI.length?0===i?this.fixedDrColor:this.colorsService.hslToRgb([this.drColor[0]+s*this.drColor[4],this.drColor[1]+n*this.drColor[5],this.drColor[2]+r*this.drColor[6],this.drColor.length>=8?this.drColor[3]+e*this.drColor[7]:null]):this.colorsI[t]},s.getIColorValue=function(t){if(this.colorsThresholds&&this.colorsLevels)for(var i=0;i<this.colorsThresholds.length;i++)if(this.colorsThresholds[i]>=t)return this.colorsLevels[i];switch(this.method){case 1:return t;case 2:return 0===t?0:Math.log(t);case 3:return 1/t*100;case 4:return 0===t?0:Math.sin(Math.log(t))+1;case 5:return t%2==0?0:10;case 6:return 10*Math.ceil(t/10);case 7:return 1;case 8:return 0===t?0:Math.atan2(t,this.maxIterations/2);case 9:return Math.tan(t);case 10:return 0===t?0:Math.log10(t);default:return-1}},s.setInnerColor=function(t,i){if(this.colorsService&&(this.innerColor=t,"number"!=typeof this.innerColor[4]&&(this.innerColor[4]=0),"number"!=typeof this.innerColor[5]&&(this.innerColor[5]=0),"number"!=typeof this.innerColor[6]&&(this.innerColor[6]=0),0==this.innerMethod))if([1,2,3,4,5,9,10].includes(this.method)){var s=this.getIColorValue(this.maxIterations);this.fixedInnerColor=this.getInnerColor(s,s,s,s,s,!0)}else this.fixedInnerColor=i.hslToRgb(this.innerColor)},s.getInnerColor=function(t,i,s,n,r,e){if(this.colorsService)return this.innerMethod>0||!0===e||this.method>4?0===t?this.fixedInnerColor:this.colorsService.hslToRgb([this.innerColor[0]+i*this.innerColor[4],this.innerColor[1]+s*this.innerColor[5],this.innerColor[2]+n*this.innerColor[6],this.innerColor.length>=8?this.innerColor[3]+r*this.innerColor[7]:null]):this.fixedInnerColor},s.setLimits=function(t,i,s){var n=0,r=0;!0===this.dW&&s>1&&(n=Math.abs(this.x2_o-this.x1_o)/2*(s-1)),i>t&&(r=Math.abs(this.y2_o-this.y1_o)/2),this.x1=this.x1_o-n,this.x2=this.x2_o+n,this.y1=this.y1_o-r,this.y2=this.y2_o+r},s.setInitPoints=function(){this.x1_i=this.x1,this.x2_i=this.x2,this.y1_i=this.y1,this.y2_i=this.y2,!0===this.xSymetry&&Math.abs(this.x1)!=Math.abs(this.x2)&&(this.xSymetry=!1)},s.setOriginPoints=function(){this.x1_o=this.x1,this.x2_o=this.x2,this.y1_o=this.y1,this.y2_o=this.y2},s.restoreInitPoints=function(){this.x1=this.x1_i,this.x2=this.x2_i,this.y1=this.y1_i,this.y2=this.y2_i,this.setOriginPoints()},s.defIntervalPts=function(t,i,s,n){this.x1=t,this.y1=i,this.x2=s,this.y2=n},s.changeParameter=function(t,i){switch(t){case"change_a":return this.a=parseFloat(i),this.setC0(),!0;case"change_b":return this.b=parseFloat(i),this.setC0(),!0;case"change_base":return this.base=parseFloat(i),!0;case"change_inner":if(this.inner=1===parseInt(i),!0===this.inner||!0===this.out)return!0;break;case"change_out":if(this.out=1===parseInt(i),!0===this.inner||!0===this.out)return!0;break;case"change_iterations":return this.maxIterations=parseInt(i),!0;case"change_method":return this.method=parseInt(i),!0;case"change_min":return this.minIterations=parseInt(i),this.min=this.minIterations,!0;case"change_x1":return this.x1=parseFloat(i),this.setOriginPoints(),!0;case"change_x2":return this.x2=parseFloat(i),this.setOriginPoints(),!0;case"change_y1":return this.y1=parseFloat(i),this.setOriginPoints(),!0;case"change_y2":return this.y2=parseFloat(i),this.setOriginPoints(),!0;case"change_funcName":return this.f=i,!0;case"change_noisex":return null===this.noise&&(this.noise=[0,0,0]),this.noise[0]=parseFloat(i),!0;case"change_noisey":return null===this.noise&&(this.noise=[0,0,0]),this.noise[1]=parseFloat(i),!0}},s.setVarParameters=function(t){return!!(t&&this.animation&&this.animation.mode&&this.animation.mode>0)&&(2===this.animation.mode&&this.animation.innerColor&&(this.innerColor[0]=Math.round(this.innerColor_o[0]+Math.sin(this.z0)*this.animation.innerColor[4]),this.innerColor[1]=Math.round(this.innerColor_o[1]+Math.sin(this.z0)*this.animation.innerColor[5]),this.innerColor[2]=Math.round(this.innerColor_o[2]+Math.sin(this.z0)*this.animation.innerColor[6]),this.fixedInnerColor=t.hslToRgb(this.innerColor)),this.applyAnimationVariation(t))},s.applyAnimationVariation=function(t){if(this.animation){if("number"==typeof this.animation.min&&(this.min+=this.animation.min),"number"==typeof this.animation.iterations&&(this.maxIterations+=this.animation.iterations),"number"==typeof this.animation.z0&&(this.z0+=this.animation.z0,this.z0=this.roundFloat(this.z0)),"number"==typeof this.animation.a&&(this.a+=this.animation.a,this.a=this.roundFloat(this.a)),"number"==typeof this.animation.b&&(this.b+=this.animation.b,this.b=this.roundFloat(this.b)),"number"==typeof this.animation.c&&(this.c+=this.animation.c,this.c=this.roundFloat(this.c)),"number"==typeof this.animation.hue&&(this.drColor[4]+=this.animation.hue),"number"==typeof this.animation.r&&(this.x1=this.x1_o*(1-this.animation.r),this.x2=this.x2_o*(1-this.animation.r),this.x1_o=this.x1,this.x2_o=this.x2,this.y1=this.y1_o*(1-this.animation.r),this.y2=this.y2_o*(1-this.animation.r),this.y1_o=this.y1,this.y2_o=this.y2),this.animation.args&&null!==this.args&&this.animation.args.length==this.args.length)for(var i=0;i<this.args.length;i++)this.animation.args[i]&&(this.args[i]+=this.animation.args[i]);return this.animation.args&&this.animation.args&&this.animation.args.rot&&(this.args.rot+=this.animation.args.rot),this.animation.noise&&"object"==typeof this.animation.noise&&null!=this.noise&&"object"==typeof this.noise&&this.noise.length>=3&&(this.noise[0]+=this.animation.noise[0],this.noise[1]+=this.animation.noise[1],this.noise[2]+=this.animation.noise[2]),this.animation.c2&&null!=this.c2&&(this.c2.a+=this.animation.c2.a,this.c2.b+=this.animation.c2.b),this.animation.multiple&&null!=this.multiple&&"object"==typeof this.animation.base&&(this.multiple.r+=this.animation.multiple.r,this.multiple.i+=this.animation.multiple.i),this.animation.breakPtParams&&null!=this.breakPtParams&&(this.breakPtParams.a+=this.animation.breakPtParams.a,this.breakPtParams.b+=this.animation.breakPtParams.b,this.breakPtParams.min+=this.animation.breakPtParams.min),"number"==typeof this.animation.base&&(this.base+=this.animation.base),this.setC0(),this.setFunctions(),this.ifsParams&&this.ifsParams.applyAnimationVariation(),!0}return!1},s.roundFloat=function(t){return Math.floor(1e8*t)/1e8},s.getInterval=function(){return[[this.x1,this.y1],[this.x1,this.y2],[this.x2,this.y1],[this.x2,this.y2]]},i}(),s=function(){function i(){}var s=i.prototype;return s.getDerivativeFunction=function(i){var s={f1:(t,i)=>t.pow(i-1).mulValues(i,0,0),f2:(i,s)=>new t(s,0).mul(i.pow(s-1)).addValues(1,0,0),f4:(t,i)=>t.pow(i-1).mulValues(i,0,0),f7:(t,i)=>t.pow(i-1).mulValues(i,0,0),f8:(i,s)=>new t(s,0).mul(i.pow(s-1)),f10:(i,s)=>new t(s,0).mul(i.pow(s-1)).addValues(-1,0,0),f31:(i,s)=>new t(1,0).sub(i.pow(s-1).mulValues(s,0,0))};return void 0===s[i]?null:s[i]},s.getFunction=function(i){return{multiple:(i,s,n,r,e,h)=>i.mul(new t(h[0],h[1])).getC(n),f1:(t,i,s,n)=>t.getC(s).pow(i).subIn(n),f2:(t,i,s,n)=>t.add(t.getC(s).pow(i)).addIn(n),f3:(t,i,s,n)=>t.pow(i-2).add(t.getC(s).pow(i)).addIn(n),f4:(t,i,s,n)=>t.getC(s).pow(i).addIn(n),f5:(t,i,s,n)=>t.getC(s).pow(i).mul(n).addIn(t),f6:(t,i,s,n)=>t.getC(s).mul(t.pow(i).addIn(n)),f7:(t,i,s,n)=>t.pow(i).addIn(n).getC(s),f8:(t,i,s,n)=>t.pow(i).getC(s).sub(n.pow(i)),f9:(t,i,s,n)=>t.pow(i).add(n.add(t.pow(i-1)).getC(s)),f10:(t,i,s,n)=>t.getC(s).pow(i).sub(t).addIn(n),f11:(t,i,s,n,r)=>t.mul(n.add(t.pow(i)).add(t)).addIn(r).subIn(t).getC(s),f12:(t,i,s,n)=>t.pow(i).getC(s).add(n.div(t)),f13:(t,i,s,n)=>t.pow(i).getC(s).add(t.pow(i-1)).addIn(t).sub(n),f14:(t,i,s,n,r)=>t.pow(i).getC(s).add(r.mul(t.pow(i-1))).addIn(t).addIn(n),f15:(t,i,s,n,r)=>t.pow(i).getC(s).addIn(n).addIn(r),f16:(t,i,s,n)=>t.pow(i).getC(s).add(n).mul(t),f17:(t,i,s,n,r)=>t.pow(i-3).getC(s).add(t.pow(i).div(t.add(r))).addIn(n),f18:(i,s,n,r)=>i.pow(s).getC(n).add(i.add(r).div(i.add(new t(1,0)))),f19:(t,i,s,n)=>t.pow(i).getC(s).add(n).div(t),f20:(t,i,s,n,r)=>t.pow(i).getC(s).sub(n),f21:(t,i,s,n)=>t.pow(i).getC(s).div(t.add(n).pow(i-1)).add(n),f22:(t,i,s,n)=>t.pow(i).getC(s).mul(t.pow(i-1).add(n)).div(t.pow(i-2).add(n)).addIn(n),f23:(t,i,s,n)=>t.pow(i-3).getC(s).add(t.pow(i)).addIn(n),f24:(t,i,s,n)=>t.pow(i).getC(s).add(t.pow(i-1)).add(n.mulReal(2)),f25:(t,i,s,n)=>t.pow(i).getC(s).add(n.add(t.pow(i-1))).add(n.add(t.pow(i-1))),f26:(t,i,s,n)=>t.pow(i).add(n).mul(t.add(n).squareAtan()).getC(s),f27:(t,i,s,n)=>t.pow(2*i).add(n).sub(t.pow(i)).getC(s),f28:(t,i,s,n)=>t.pow(i).add(n).sub(t.pow(2)).getC(s),f29:(t,i,s,n)=>n.add(t.pow(i)).abs().getC(s),f30:(t,i,s,n)=>t.pow(i).getC(s).abs().div(t).sub(n),f31:(t,i,s,n)=>t.getC(s).sub(t.pow(i)).sub(n),f32:(t,i,s,n)=>t.getC(s).sub(t.pow(i)).sub(n.abs()),f33:(t,i,s,n)=>t.sub(t.mul(n).pow(i)).sub(n).getC(s),f34:(t,i,s,n)=>t.getC(s).sub(t.pow(i/2).addIn(n)),f35:(i,s,n,r,e,h)=>i.sub(i.mul(new t(h[0],h[1]))),f36:(t,i,s,n)=>t.pow(i).getC(s).add(t.pow(i-1)).add(t).sub(n).sub(n),f37:(t,i,s,n)=>t.abs().getC(s).pow(i).add(n),f38:(t,i,s,n)=>t.getC(s).abs().pow(i).sub(t).addIn(n),f39:(t,i,s,n)=>t.abs().pow(i).addIn(n).getC(s)}[i]},s.getFunctionDefinition=function(t,i,s,n,r){var e={f1:()=>"f(z)^n-c",f2:t=>"z+(f(z)^n)+c",f3:t=>"z^"+(t-2)+"+f(z)^n+c",f4:t=>"f(z)^n+c",f5:t=>"f(z)^n.c+z",f6:t=>"f(z)^n+c.z",f7:t=>"f(z^n+c)",f8:t=>"f(z^n+(c+z^"+(t-1)+"))",f9:t=>"f(z^n)-c^n",f10:t=>"f(z)^n-z+c",f11:t=>"",f12:t=>"f(z^n)+c/z",f13:t=>"f(z^n)+z^"+(t-1)+"+z-c",f14:t=>"",f15:t=>"f(z^n)+c+(2,0)",f16:t=>"(f(z^n)+c).z",f17:t=>"",f18:t=>"",f19:t=>"(f(z^n)+c)/z",f20:t=>"f(z^n)-c",f21:t=>"",f22:t=>"",f23:t=>"f(z^"+(t-3)+")+z^n+c",f24:t=>"f(z^n)+z^"+(t-1)+"+2.c",f25:t=>"",f26:t=>"",f27:t=>"f(z^"+2*t+"+c-z^n)",f28:t=>"f(z^n+c-z^2)",f29:t=>"f(|c+(z^n)|)",f30:t=>"|f(z^n)|/z-c",f31:t=>"f(z)-z^n-c",f32:t=>"z-z^n-|c|",f33:t=>"f(z-((z.c)^n)-c)",f36:t=>"f(z^n)+z^n-1+z-c",multiple:(t,i)=>"("+i[0]+"+"+i[1]+"i).z"};if(e[t]){var h=null!==r?" with c = ("+r.r+","+r.i+")":"",a=e[t](s,n,r);if("string"==typeof a){var o="";return"("==(o=""===i?this.replaceAllOccurrences(a.replace(/f\((.*?)\)/g,"$1"),"^n","^"+s):this.replaceAllOccurrences(this.replaceAllOccurrences(a,"f(",i+"(").trim(),"^n","^"+s)).substring(0,1)&&")"==o.substring(o.length-1)?this.removeParentheses(o.substring(1).substring(0,o.length-2)):this.removeParentheses(o+h)}}return""},s.removeParentheses=function(t){return t.startsWith("(")&&t.endsWith(")")?t.slice(1,-1):t},s.replaceAllOccurrences=function(t,i,s){var n=i.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),r=new RegExp(n,"g");return t.replace(r,s)},i}();function n(t,i){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},n(t,i)}var r=function(t){function i(){return t.apply(this,arguments)||this}var r,e;e=t,(r=i).prototype=Object.create(e.prototype),r.prototype.constructor=r,n(r,e);var h=i.prototype;return h.setFunctions=function(){var t=new s;return this.currentFunction=t.getFunction(this.type),this.derivativeParams?this.derivativeFunction=t.getFunction(this.derivativeParams.type):""===this.f&&(this.derivativeFunction=t.getDerivativeFunction(this.type)),this.functionDefinition="f(z) = "+t.getFunctionDefinition(this.type,this.f,this.base,this.args,this.c0),null!=this.multiple&&(this.functionDefinition+=", a = ("+this.multiple.r+","+this.multiple.i+")"),this.relativeC2||(this.c2?this.functionDefinition+=", c2 = ("+this.c2.r+","+this.c2.i+")":this.functionDefinition+=", c2 = (0, 0)"),"function"==typeof this.currentFunction},h.getNew=function(){return new i},i}(i);function e(t,i){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},e(t,i)}var h=function(i){function s(){var s;return(s=i.call(this)||this).params=new r,s.c2_0=new t(2,0),s.params.multiple=new t(1,0),s.iterations=0,s.errorLimit=.01,s.iFunction=null,s.derivativeFunction=null,s}var n,h;h=i,(n=s).prototype=Object.create(h.prototype),n.prototype.constructor=n,e(n,h);var a=s.prototype;return a.setParameters=function(i){this.params=i,null==this.params.multiple&&(this.params.multiple=new t(1,0))},a.initialize=function(t){this.colorsService=t},a.getPt=function(t,i){this.initResults();var s=this.params.ifsParams&&this.params.ifsParams.mode>0?this.getIFSn(t,i,0):this.getI(t,i);if(null===s)return null;var n=this.get3DValue(s),r=this.getV(this.params.method,s,t,i),e=r,h=r,a=r,o=r,u=r,l=r,c=r,f=r;return!0===this.params.out&&s<this.params.maxIterations&&s>=this.params.minIterations?[t,i,n,this.params.getDrColor(s,r,u,l,c,f),s,r]:!0===this.params.inner&&s===this.params.maxIterations?(this.params.innerMethod>0&&(h=e=this.getV(this.params.innerMethod,s,t,i),a=e,o=e),[t,i,n,this.params.getInnerColor(r,e,h,a,o,!1),s,r]):null},a.getI=function(i,s,n,r){var e=null===this.params.zOrigin?new t(i,s,n):this.params.zOrigin,h=null===this.params.c0?new t(i,s,n):this.params.c0,a=null===this.params.c2?new t(i,s,n):this.params.c2,o=0,u=0,l=this.params.maxIterations,c=this.errorLimit;do{var f=this.getNewZ(e,h,a,u);if(null===f)break;o=Math.abs(f.sub(e).r),e=f,this.setResult(e.squaresSum()),r&&r.push([e.i,e.r,0,null,u]),u++}while(o>c&&u<l);return this.saveZ(e),u},a.getNewZ=function(t,i,s,n){return t.sub(this.fZ_DerivativefZ(t,i,n).mul(this.params.multiple)).addIn(s)},a.fZ_DerivativefZ=function(t,i,s){var n=this.fZ(t,i,this.params.base,s);return null===this.params.derivativeFunction?n.div(this.fZ(t.add(this.cDerivative),i,this.params.base,s).sub(n).div(this.cDerivative)):n.div(this.derivativefZ(t,i,this.params.base))},a.derivativefZ=function(t,i,s){return this.params.derivativeFunction?this.params.derivativeFunction(t,s,this.params.f,i):t},a.fZ=function(i,s,n,r){return this.params.currentFunction?this.params.breakPtParams&&r>this.params.breakPtParams.min?this.addNoise(this.params.currentFunction(i,n,this.params.breakPtParams.f,new t(this.params.breakPtParams.a,this.params.breakPtParams.b,this.params.breakPtParams.c),this.c2_0,this.params.args),r):this.addNoise(this.params.currentFunction(i,n,this.params.f,s,this.c2_0,this.params.args),r):i},a.getIFSn=function(i,s,n){this.it=0;var r=this.params.zFromOrigin?new t(0,0,0):new t(i,s,n),e=null===this.params.c0?new t(i,s,n):this.params.c0,h=null===this.params.c2?new t(i,s,n):this.params.c2;return this.getIFSi(r,this.getNewZ(r,e,h,!1),e,h,0)},a.getIFSi=function(t,i,s,n,r){return this.it++,this.it>=this.params.maxIterations||r>=this.params.ifsParams.maxIterations?(this.saveZ(t),0):Math.abs(i.sub(t).r)<this.errorLimit?(this.saveZ(t),1):this.getIFSi(i,this.getNewZ(t,s,n),s,n,r+1)+this.getIFSi(i,this.getIfsZ(t,s),s,n,r+1)},a.getIfsZ=function(t,i){var s=this.fZ_ifs(t,i);return 3==this.params.ifsParams.mode?t.sub(s.div(this.fZ_ifs(t.add(this.cDerivative),i,this.params.base).sub(s).div(this.cDerivative))):this.params.ifsParams.currentFunction?s:void 0},a.fZ_ifs=function(t,i){return this.params.ifsParams.currentFunction(t,this.params.ifsParams.base,this.params.ifsParams.f,null!==this.params.ifsParams.c0?this.params.ifsParams.c0:i,this.c2_0,this.params.ifsParams.args)},s}(function(){function i(){this.getV=(t,i,s,n)=>{switch(t){case 11:case 13:return this.getLastMagnitude();case 12:return this.getLastArgument();case 14:return this.getLastSquaresSum();case 16:return this.minResult==1/0?1e4:Math.sqrt(100*this.minResult);case 17:return this.getLastArgument()*this.getLastSquaresSum();case 18:return 100*Math.tanh(this.getLastMagnitude()*Math.log(this.getLastMagnitude())/this.getDzMagnitude()*1e3);case 19:return Math.log(this.getDzMagnitude());case 20:return Math.abs(Math.sin(this.getLastSquaresSum()*Math.PI));case 21:return Math.log(this.getLastArgument());case 22:return Math.log(this.getLastSquaresSum());case 25:return this.lastZ.i/2/Math.PI-.09;case 26:return this.colorsService.lerpForPoint(s,n+i/10,.1);case 27:return this.colorsService.lerpForPoint(s+2*this.getLastSquaresSum(),n+2*this.getLastSquaresSum(),.1);case 28:return this.minLp==1/0?(Math.sin(Math.log(i))+1)/2:Math.abs(this.minLp)/Math.sqrt(Math.pow(this.params.x2-this.params.x1,2)+Math.pow(this.params.y2-this.params.y1,2))*4;case 29:return this.minLp==1/0?(Math.sin(Math.log(i))+1)/2:10*Math.log(1+Math.abs(this.minLp));case 32:if(this.minLp==1/0)return Math.log(1+i);var r=10*Math.log10(1+Math.abs(this.minLp));return r>10?Math.log(1+i):r;case 31:return 0==this.maxLp?(Math.sin(Math.log(i))+1)/2:Math.abs(this.maxLp)/Math.sqrt(Math.pow(this.params.x2-this.params.x1,2)+Math.pow(this.params.y2-this.params.y1,2))*4;case 50:return Math.floor(Math.random()*i);default:return i}},this.lastZ=null,this.colorsService=null,this.lastDz=null,this.minResult=1/0;var i=1e-5;this.cDerivative=new t(i,i),this.minLp=1/0,this.maxLp=0}var s=i.prototype;return s.initResults=function(){this.lastZ=null,this.minResult=1/0,this.minLp=1/0,this.maxLp=0},s.setMinLp=function(t){if(t&&this.params.lpNb>0){var i=t.LyapunovExponent(this.params.lpNb);Math.abs(i)<Math.abs(this.minLp)&&(this.minLp=i),Math.abs(i)>Math.abs(this.maxLp)&&(this.maxLp=i)}},s.setResult=function(t){return t<this.minResult&&(this.minResult=t),t},s.saveZ=function(i){i&&(this.lastZ=new t(i.r,i.i,i.t),this.setMinLp(i))},s.saveDz=function(i){i&&(this.lastDz=new t(i.r,i.i))},s.addNoise=function(t,i){return t&&this.params.noise?t.addValuesIn(this.params.noise[0]*i,this.params.noise[1]*i,this.params.noise[2]*i):t},s.get3DValue=function(t){var i=null;if(this.params.render3D)if(this.params.zThresholds&&this.params.zValues){for(var s=0;s<this.params.zThresholds.length;s++)if(this.params.zThresholds[s]>=t){i=this.params.zValues[s];break}}else i=-Math.log10(t);return i},s.getLastMagnitude=function(){return null==this.lastZ?0:this.lastZ.getMagnitude()},s.getLastArgument=function(){return null==this.lastZ?0:this.lastZ.getArgument()},s.getLastSquaresSum=function(){return null==this.lastZ?0:this.lastZ.squaresSum()},s.getDzSquaresSum=function(){return null==this.lastDz?0:this.lastDz.squaresSum()},s.getDzMagnitude=function(){return null==this.lastDz?0:this.lastDz.getMagnitude()},i}());self.addEventListener("message",(function(t){self.postMessage=self.webkitPostMessage||self.postMessage;var i,s=[];if(t.data.pts){var n=new h,e=new r;e.setData(t.data.data),n.setParameters(e);for(var a=0;a<t.data.pts.length;a++){var o=n.getPt(t.data.pts[a][0],t.data.pts[a][1]);null!=o&&s.push([t.data.ptsCanvas[a][0],t.data.ptsCanvas[a][1],o[2],o[3],o[4],o[5]])}}self.postMessage((i=s,JSON.stringify(i,(function(t,i){if(i instanceof Function||"function"==typeof i){var s=i.toString();return s.length<8||"function"!==s.substring(0,8)?"_NuFrRa_"+s:s}return i instanceof RegExp?"_PxEgEr_"+i:i}))))}),!1)})();